# Stories for relapse dialogs
version: "3.1"

stories:

## 1a: Trigger relapse dialog - smoking
- story: Relapse phase triggered smoke
  steps:
    - intent: relapse_dialog
    - action: utter_relapse_intro_codeword
    - action: utter_relapse_intro_offer_help
    - action: utter_relapse_smoke_or_pa
    - action: utter_ask_smoke_or_pa
    - action: two_options_form
    - active_loop: two_options_form
    - slot_was_set:
      - one_or_two: 1
    - active_loop: null
    - checkpoint: smoke_parent


## 1b: Trigger relapse dialog - PA
- story: Relapse phase triggered PA
  steps:
    - intent: relapse_dialog
    - action: utter_relapse_intro_codeword
    - action: utter_relapse_intro_offer_help
    - action: utter_relapse_smoke_or_pa
    - action: utter_ask_smoke_or_pa
    - action: two_options_form
    - active_loop: two_options_form
    - slot_was_set:
      - one_or_two: 2
    - active_loop: null
    - checkpoint: pa_parent

## Stories for smoking
## 2a: Parent for Smoking - crave
- story: smoking parent crave
  steps:
  - checkpoint: smoke_parent
  - action: action_reset_one_or_two_slot
  - action: utter_debug_ab
  - action: utter_specify_smoke
  - action: utter_ask_crave_lapse_relapse
  - action: crave_lapse_relapse_form
  - active_loop: crave_lapse_relapse_form
  - slot_was_set:
    - crave_lapse_relapse: 1
  - active_loop: null
  - checkpoint: smoke_hrs

## 2b: Parent for Smoking - lapse
- story: smoking parent lapse
  steps:
  - checkpoint: smoke_parent
  - action: action_reset_one_or_two_slot
  - action: utter_debug_ab
  - action: utter_specify_smoke
  - action: utter_ask_crave_lapse_relapse
  - action: crave_lapse_relapse_form
  - active_loop: crave_lapse_relapse_form
  - slot_was_set:
    - crave_lapse_relapse: 2
  - active_loop: null
  - checkpoint: smoke_lapse

## 2c Parent for Smoking - relapse
- story: smoking parent relapse
  steps:
  - checkpoint: smoke_parent
  - action: action_reset_one_or_two_slot
  - action: utter_debug_ab
  - action: utter_specify_smoke
  - action: utter_ask_crave_lapse_relapse
  - action: crave_lapse_relapse_form
  - active_loop: crave_lapse_relapse_form
  - slot_was_set:
    - crave_lapse_relapse: 3
  - active_loop: null
  - checkpoint: smoke_relapse

## 3a smoking - HRS
- story: smoke hrs  # TODO: store in database the number of times this story is executed (create issue)
  steps:
  - checkpoint: smoke_hrs
  - action: utter_smoke_crave_1
  - action: utter_smoke_crave_2
  - action: utter_smoke_crave_3
  - action: utter_smoke_crave_4
  - action: utter_smoke_crave_5
  - action: utter_smoke_crave_6
  - action: utter_smoke_crave_7
  - action: utter_smoke_crave_8
  - action: utter_smoke_crave_9
  - action: utter_smoke_crave_10  # TODO: insert form


  ## 3b smoking - lapse
- story: smoke hrs  # TODO: store in database the number of times this story is executed (create issue)
  steps:
    - checkpoint: smoke_lapse
    - action: utter_smoke_lapse_1
    - action: utter_smoke_lapse_2  # TODO: form to ask what smoked
    - action: utter_smoke_lapse_3  # TODO: form to ask how many, store answer in DB.
    - action: utter_smoke_lapse_4  # TODO: Validate the previous answer with yes/no
    - action: utter_smoke_lapse_5
    - action: utter_smoke_lapse_6
    - action: utter_smoke_lapse_7
    - action: utter_smoke_lapse_8
    - action: utter_smoke_lapse_9
    - action: utter_smoke_crave_10
    - action: utter_smoke_crave_11
    - action: utter_smoke_crave_12  # TODO: insert form, numbers 1-7
    - action: utter_smoke_crave_13
    - action: utter_smoke_crave_14  # TODO: insert form, multiple answers are allowed
    - action: utter_smoke_crave_15
    - action: utter_smoke_crave_16
    - action: utter_smoke_crave_17  # TODO: insert form: 1-6, multiple answers allowed. Store to DB
    - action: utter_smoke_crave_18  # TODO: insert form: free text
    - action: utter_smoke_crave_19
    - action: utter_smoke_crave_20

## Stories for PA
## 2d Parent for PA - HRS
- story: pa parent hrs
  steps:
  - checkpoint: pa_parent
  - action: action_reset_one_or_two_slot
  - action: utter_pa_define_1
  - action: utter_pa_define_2

## 2e Parent for PA - Relapse
- story: pa parent
  steps:
  - checkpoint: pa_parent
  - action: action_reset_one_or_two_slot
  - action: utter_pa_define_1
  - action: utter_pa_define_2